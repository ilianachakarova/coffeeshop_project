<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">>

<head>
    <th:block th:include="~{fragments/head}"/>
</head>

<body>
<div class="container ">
    <th:block sec:authorize="hasRole('ROLE_USER')">
        <th:block th:include="~{fragments/user-navbar}"></th:block>
    </th:block>
    <th:block sec:authorize="hasAnyRole('ROLE_ROOT')">
        <th:block th:include="~{fragments/admin-navbar}"></th:block>
    </th:block>
    <th:block sec:authorize="hasAnyRole('ROOT_ADMIN')">
        <th:block th:include="~{fragments/admin-navbar}"></th:block>
    </th:block>
    <div class="container mt-lg-5  bg-transparent h-100">
        <div class="row mb-3 mx-auto">
            <div class='button-holder mt-5'>
                <button id='fetch-button-hot' class='btn btn-info justify-content-center'>Fetch Hot Drinks</button>
                <button id='fetch-button-cold' class='btn btn-info justify-content-center'>Fetch Cold Drinks</button>
                <button id='fetch-button-snack' class='btn btn-info justify-content-center'>Fetch Snacks</button>
                <button id='fetch-button-cake' class='btn btn-info justify-content-center'>Fetch Cakes</button>
                <button id='clear-button' class='btn btn-secondary'>Clear Data</button>

            </div>
            <div id="cont" class='data-container mt-5'>
                <table id="table-id" style="display: none"  class="table table-hover w-100 text-center align-content-center table-custom">


                </table>
            </div>
        </div>

        <div class="row tm-content-row tm-mt-big">

            <div class="tm-col tm-col-big">
                <div class="bg-white tm-block h-100">

                </div>
            </div>
            <div class="tm-col tm-col-big">
                <div class="bg-white tm-block h-100">


                </div>
            </div>
            <div class="tm-col tm-col-small">
                <div class="bg-white tm-block h-100">
                    <div id="googleGauge" style="width: 100%; height: 100%;"></div>
                </div>
            </div>


            <div class="tm-col tm-col-big">
                <div class="bg-white tm-block h-100">
                    <div class="row">
                        <div class="col-8">
                            <h2 class="tm-block-title d-inline-block">Who are my colleagues today</h2>
                    </div>

                </div>
            </div>
            </div>

            <div class="tm-col tm-col-big">
                <div class="bg-white tm-block h-100">
<!--                    <div class="auto-jsCalendar w-100"></div>-->
                </div>
            </div>

            <div class="tm-col tm-col-small">
                <div class="bg-white tm-block h-100">
                    <h2 class="tm-block-title">pie chart</h2>

                </div>
            </div>

        </div>
    </div>

    <th:block th:include="~{fragments/footer}"></th:block>
</div>

</body>

<script>
    // jQuery Event handlers
    $('#fetch-button-hot').click(() => {
        fetchByCat('hot-drinks')
    }); // Fetch and render the data

    $('#fetch-button-cold').click(() => {
        fetchByCat('cold-drinks')
    }); // Fetch and render the data

    $('#fetch-button-snack').click(() => {
        fetchByCat('snacks')
    }); // Fetch and render the data
    $('#fetch-button-cake').click(() => {
        fetchByCat('cakes')
    }); // Fetch and render the data

    let fetchByCat = function(category){
        let t = document.getElementById('table-id');
        if (t.style.display === "none") {
            t.style.display = "block";

        }
        let divHeading = ` <tr>
                    <th>No</th>
                    <th>Name</th>
                    <th>Category</th>
                    <th>Picture</th>
                    <th>Quantity</th>
                    <th>Add</th>
                </tr>`;
        $('#table-id').append(divHeading);
        fetch('http://localhost:8000/fetch/'+category)
            .then((response) => response.json())
            .then((json) => json.forEach((x, y) => {
                let divColumn = ` <tr>
                            <th>${x.id}</th>
                            <th>${x.name}</th>
                            <th>${x.category}</th>
                            <th><img src="${x.pictureUrl}" class="img-thumbnail img-table"></th>
                            <th>${x.quantity}</th>
                            <th>
                            <form th:action="@{/orders/add-product/{id}(id=${x.id})} method="post">
                            <button type="button" class="btn btn-success">Add</button>
                            </form>

                            </th>
                            </tr>`
                $('#table-id').append(divColumn);

            }))
    }
    $('#clear-button').click(() => $('#table-id').empty()); // Clear the data

</script>


</html>